---
// https://medium.com/fredwong-it/aws-s3-no-access-control-allow-origin-header-is-present-on-the-requested-resource-ce755b657931
// https://krpano.com/examples/?maps&version=122
import type { MarkdownLayoutProps } from "astro";
const title = "360&deg; photo";

type Props = MarkdownLayoutProps<{
  author: string;
  date: string;
  title: string;
  previewUrl: string;
  photoUrl: string;
  isDraft: boolean;
}>;

const { frontmatter } = Astro.props;
---

<!-- <!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>{title}</title>
    <meta name="description" content="360° Image - A-Frame" />
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-entity
        camera
        look-controls
        wasd-controls="enabled:false"
        position="0 0 0"></a-entity>
      <a-assets>
        <img
          id="skyTexture"
          src={frontmatter.photoUrl}
          crossorigin="anonymous"
        />
      </a-assets>
      <a-sky src="#skyTexture"></a-sky>
    </a-scene>
  </body>
</html> --><!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/core/index.min.css"
    />
    <script is:inline type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three/build/three.module.js",
          "@photo-sphere-viewer/core": "https://cdn.jsdelivr.net/npm/@photo-sphere-viewer/core/index.module.js"
        }
      }
    </script>
    <style>
      body {
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #000;
      }
      #viewer {
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <!-- Контейнер для Photo Sphere Viewer -->
    <div id="viewer"></div>

    <script is:inline type="module" define:vars={{ frontmatter }}>
      import { Viewer } from "@photo-sphere-viewer/core";
      import { GyroscopePlugin } from "@photo-sphere-viewer/gyroscope-plugin";

      // const viewer =
      new Viewer({
        container: document.querySelector("#viewer"),
        // panorama: "https://storage.clo.ru/s3-masle-net-default-bucket/Samui_Villa_291224.JPG",
        panorama: frontmatter.photoUrl,
        plugins: [GyroscopePlugin],
      });
    </script>
    <!-- <script>
      // Инициализация Photo Sphere Viewer
      const viewer = new PhotoSphereViewer.Viewer({
        container: document.getElementById("viewer"), // Контейнер для отображения
        // panorama: 'https://example.com/your-360-image.jpg', // URL 360-градусного изображения
        panorama:
          "https://storage.clo.ru/s3-masle-net-default-bucket/Samui_Villa_291224.JPG", // URL 360-градусного изображения
        defaultLat: 0, // Начальный угол обзора по широте
        defaultLong: Math.PI, // Начальный угол обзора по долготе
        navbar: true, // Отображение панели управления
        caption: "Your 360 Image © 2024", // Текстовое описание
        touchmoveTwoFingers: true, // Использование двух пальцев для перемещения на мобильных устройствах
      });

      // События Photo Sphere Viewer
      viewer.on("ready", () => {
        console.log("Photo Sphere Viewer готов!");
      });
    </script> -->
  </body>
</html>
